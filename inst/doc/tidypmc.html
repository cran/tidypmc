<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Chris Stubben" />

<meta name="date" content="2019-07-29" />

<title>Introduction to tidypmc</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to tidypmc</h1>
<h4 class="author">Chris Stubben</h4>
<h4 class="date">July 29, 2019</h4>



<p>The <code>tidypmc</code> package parses XML documents in the Open Access subset of <a href="https://europepmc.org">Pubmed Central</a>. Download the full text using <code>pmc_xml</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidypmc)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">doc &lt;-<span class="st"> </span><span class="kw">pmc_xml</span>(<span class="st">&quot;PMC2231364&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">doc</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#  {xml_document}</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#  &lt;article article-type=&quot;research-article&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#  [1] &lt;front&gt;\n  &lt;journal-meta&gt;\n    &lt;journal-id journal-id-type=&quot;nlm-ta&quot;&gt; ...</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#  [2] &lt;body&gt;\n  &lt;sec&gt;\n    &lt;title&gt;Background&lt;/title&gt;\n    &lt;p&gt;&lt;italic&gt;Yersi ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#  [3] &lt;back&gt;\n  &lt;ack&gt;\n    &lt;sec&gt;\n      &lt;title&gt;Acknowledgements&lt;/title&gt;\n  ...</span></a></code></pre></div>
<p>The package includes five functions to parse the <code>xml_document</code>.</p>
<table>
<colgroup>
<col width="16%"></col>
<col width="83%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">R function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>pmc_text</code></td>
<td align="left">Split section paragraphs into sentences with full path to subsection titles</td>
</tr>
<tr class="even">
<td align="left"><code>pmc_caption</code></td>
<td align="left">Split figure, table and supplementary material captions into sentences</td>
</tr>
<tr class="odd">
<td align="left"><code>pmc_table</code></td>
<td align="left">Convert table nodes into a list of tibbles</td>
</tr>
<tr class="even">
<td align="left"><code>pmc_reference</code></td>
<td align="left">Format references cited into a tibble</td>
</tr>
<tr class="odd">
<td align="left"><code>pmc_metadata</code></td>
<td align="left">List journal and article metadata in front node</td>
</tr>
</tbody>
</table>
<p><code>pmc_text</code> splits paragraphs into sentences and removes any tables, figures or formulas that are nested within paragraph tags, replaces superscripted references with brackets, adds carets and underscores to other superscripts and subscripts and includes the full path to the subsection title.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">txt &lt;-<span class="st"> </span><span class="kw">pmc_text</span>(doc)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">txt</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#  # A tibble: 194 x 4</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#     section    paragraph sentence text                                                               </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#     &lt;chr&gt;          &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                                              </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#   1 Title              1        1 Comparative transcriptomics in Yersinia pestis: a global view of e…</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#   2 Abstract           1        1 Environmental modulation of gene expression in Yersinia pestis is …</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#   3 Abstract           1        2 Using cDNA microarray technology, we have analyzed the global gene…</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#   4 Abstract           2        1 To provide us with a comprehensive view of environmental modulatio…</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#   5 Abstract           2        2 Almost all known virulence genes of Y. pestis were differentially …</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#   6 Abstract           2        3 Clustering enabled us to functionally classify co-expressed genes,…</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#   7 Abstract           2        4 Collections of operons were predicted from the microarray data, an…</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#   8 Abstract           2        5 Several regulatory DNA motifs, probably recognized by the regulato…</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#   9 Abstract           3        1 The comparative transcriptomics analysis we present here not only …</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#  10 Background         1        1 Yersinia pestis is the etiological agent of plague, alternatively …</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#  # … with 184 more rows</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="kw">count</span>(txt, section)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#  # A tibble: 21 x 2</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#     section                                                  n</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#     &lt;chr&gt;                                                &lt;int&gt;</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#   1 Abstract                                                 8</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#   2 Authors' contributions                                   6</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#   3 Background                                              20</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#   4 Conclusion                                               3</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#   5 Methods; Clustering analysis                             7</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#   6 Methods; Collection of microarray expression data       17</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#   7 Methods; Discovery of regulatory DNA motifs              8</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#   8 Methods; Gel mobility shift analysis of Fur binding     13</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#   9 Methods; Operon prediction                               5</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#  10 Methods; Verification of predicted operons by RT-PCR     7</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#  # … with 11 more rows</span></a></code></pre></div>
<p><code>pmc_caption</code> splits figure, table and supplementary material captions into sentences.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">cap1 &lt;-<span class="st"> </span><span class="kw">pmc_caption</span>(doc)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#  Found 5 figures</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#  Found 4 tables</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#  Found 3 supplements</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">filter</span>(cap1, sentence <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#  # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#     tag      label               sentence text                                                       </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#     &lt;chr&gt;    &lt;chr&gt;                  &lt;int&gt; &lt;chr&gt;                                                      </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#   1 figure   Figure 1                   1 Environmental modulation of expression of virulence genes. </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#   2 figure   Figure 2                   1 RT-PCR analysis of potential operons.                      </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#   3 figure   Figure 3                   1 Schematic representation of the clustered microarray data. </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#   4 figure   Figure 4                   1 Graphical representation of the consensus patterns by moti…</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#   5 figure   Figure 5                   1 EMSA analysis of the binding of Fur protein to promoter DN…</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#   6 table    Table 1                    1 Stress-responsive operons in Y. pestis predicted from micr…</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#   7 table    Table 2                    1 Classification of the gene members of the cluster II in Fi…</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#   8 table    Table 3                    1 Motif discovery for the clustering genes                   </span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#   9 table    Table 4                    1 Designs for expression profiling of Y. pestis              </span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#  10 supplem… Additional file 1 …        1 Growth curves of Y. pestis strain 201 under different cond…</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#  11 supplem… Additional file 2 …        1 All the transcriptional changes of 4005 genes of Y. pestis…</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#  12 supplem… Additional file 3 …        1 List of oligonucleotide primers used in this study.</span></a></code></pre></div>
<p><code>pmc_table</code> formats tables by collapsing multiline headers, expanding rowspan and colspan attributes and adding subheadings into a new column.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">tab1 &lt;-<span class="st"> </span><span class="kw">pmc_table</span>(doc)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#  Parsing 4 tables</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#  Adding footnotes to Table 1</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">sapply</span>(tab1, nrow)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#  Table 1 Table 2 Table 3 Table 4 </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#       39      23       4      34</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">tab1[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#  # A tibble: 39 x 5</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#     subheading           `Potential operon (r … `Gene ID`  `Putative or predicted fu… `Reference (s)`</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#     &lt;chr&gt;                &lt;chr&gt;                  &lt;chr&gt;      &lt;chr&gt;                      &lt;chr&gt;          </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#   1 Iron uptake or heme… yfeABCD operon* (r &gt; … YPO2439-2… Transport/binding chelate… yfeABCD [54]   </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#   2 Iron uptake or heme… hmuRSTUV operon (r &gt; … YPO0279-0… Transport/binding hemin    hmuRSTUV [55]  </span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#   3 Iron uptake or heme… ysuJIHG* (r &gt; 0.95)    YPO1529-1… Iron uptake                -              </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#   4 Iron uptake or heme… sufABCDS* (r &gt; 0.90)   YPO2400-2… Iron-regulated Fe-S clust… -              </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#   5 Iron uptake or heme… YPO1854-1856* (r &gt; 0.… YPO1854-1… Iron uptake or heme synth… -              </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#   6 Sulfur metabolism    tauABCD operon (r &gt; 0… YPO0182-0… Transport/binding taurine  tauABCD [56]   </span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#   7 Sulfur metabolism    ssuEADCB operon (r &gt; … YPO3623-3… Sulphur metabolism         ssu operon [57]</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#   8 Sulfur metabolism    cys operon (r &gt; 0.92)  YPO3010-3… Cysteine synthesis         -              </span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#   9 Sulfur metabolism    YPO1317-1319 (r &gt; 0.9… YPO1317-1… Sulfur metabolism?         -              </span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#  10 Sulfur metabolism    YPO4109-4111 (r &gt; 0.9… YPO4109-4… Sulfur metabolism?         -              </span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#  # … with 29 more rows</span></a></code></pre></div>
<p>Captions and footnotes are added as attributes.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">attributes</span>(tab1[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#  $names</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#  [1] &quot;subheading&quot;                     &quot;Potential operon (r value)&quot;    </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#  [3] &quot;Gene ID&quot;                        &quot;Putative or predicted function&quot;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#  [5] &quot;Reference (s)&quot;                 </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#  </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#  $row.names</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#   [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#  [33] 33 34 35 36 37 38 39</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#  </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#  $class</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#  [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#  </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#  $caption</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#  [1] &quot;Stress-responsive operons in Y. pestis predicted from microarray expression data&quot;</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#  </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#  $footnotes</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#  [1] &quot;'r' represents the correlation coefficient of adjacent genes; '*' represent the defined operon has the similar expression pattern in two other published microarray datasets [7, 21]; '?' inferred functions of uncharacterized genes; '-' means the corresponding operons have not been experimentally validated in other bacteria.&quot;</span></a></code></pre></div>
<p>Use <code>collapse_rows</code> to join column names and cell values in a semi-colon delimited string (and then search using functions in the next section).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">collapse_rows</span>(tab1, <span class="dt">na.string=</span><span class="st">&quot;-&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#  # A tibble: 100 x 3</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#     table     row text                                                                               </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#     &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;                                                                              </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#   1 Table 1     1 subheading=Iron uptake or heme synthesis; Potential operon (r value)=yfeABCD opero…</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#   2 Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r value)=hmuRSTUV oper…</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#   3 Table 1     3 subheading=Iron uptake or heme synthesis; Potential operon (r value)=ysuJIHG* (r &gt;…</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#   4 Table 1     4 subheading=Iron uptake or heme synthesis; Potential operon (r value)=sufABCDS* (r …</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#   5 Table 1     5 subheading=Iron uptake or heme synthesis; Potential operon (r value)=YPO1854-1856*…</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#   6 Table 1     6 subheading=Sulfur metabolism; Potential operon (r value)=tauABCD operon (r &gt; 0.90)…</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#   7 Table 1     7 subheading=Sulfur metabolism; Potential operon (r value)=ssuEADCB operon (r &gt; 0.97…</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#   8 Table 1     8 subheading=Sulfur metabolism; Potential operon (r value)=cys operon (r &gt; 0.92); Ge…</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#   9 Table 1     9 subheading=Sulfur metabolism; Potential operon (r value)=YPO1317-1319 (r &gt; 0.97); …</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#  10 Table 1    10 subheading=Sulfur metabolism; Potential operon (r value)=YPO4109-4111 (r &gt; 0.90); …</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#  # … with 90 more rows</span></a></code></pre></div>
<p><code>pmc_reference</code> extracts the id, pmid, authors, year, title, journal, volume, pages, and DOIs from reference tags.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">ref1 &lt;-<span class="st"> </span><span class="kw">pmc_reference</span>(doc)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#  Found 76 citation tags</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">ref1</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#  # A tibble: 76 x 9</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#        id pmid   authors                  year title                 journal   volume pages doi      </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#     &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;                   &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#   1     1 89938… Perry RD, Fetherston JD  1997 Yersinia pestis--eti… Clin Mic… 10     35-66 &lt;NA&gt;     </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#   2     2 16053… Hinnebusch BJ            2005 The evolution of fle… Curr Iss… 7      197-… &lt;NA&gt;     </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#   3     3 64693… Straley SC, Harmon PA    1984 Yersinia pestis grow… Infect I… 45     655-… &lt;NA&gt;     </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#   4     4 15557… Huang XZ, Lindler LE     2004 The pH 6 antigen is … Infect I… 72     7212… 10.1128/…</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#   5     5 15721… Pujol C, Bliska JB       2005 Turning Yersinia pat… Clin Imm… 114    216-… 10.1016/…</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#   6     6 12732… Rhodius VA, LaRossa RA   2003 Uses and pitfalls of… Curr Opi… 6      114-… 10.1016/…</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#   7     7 15342… Motin VL, Georgescu AM…  2004 Temporal global chan… J Bacter… 186    6298… 10.1128/…</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#   8     8 15557… Han Y, Zhou D, Pang X,…  2004 Microarray analysis … Microbio… 48     791-… &lt;NA&gt;     </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#   9     9 15777… Han Y, Zhou D, Pang X,…  2005 DNA microarray analy… Microbes… 7      335-… 10.1016/…</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#  10    10 15808… Han Y, Zhou D, Pang X,…  2005 Comparative transcri… Res Micr… 156    403-… 10.1016/…</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#  # … with 66 more rows</span></a></code></pre></div>
<p>Finally, <code>pmc_metadata</code> saves journal and article metadata to a list.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">pmc_metadata</span>(doc)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#  $PMCID</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#  [1] &quot;PMC2231364&quot;</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#  $Title</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#  [1] &quot;Comparative transcriptomics in Yersinia pestis: a global view of environmental modulation of gene expression&quot;</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#  $Authors</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#  [1] &quot;Yanping Han, Jingfu Qiu, Zhaobiao Guo, He Gao, Yajun Song, Dongsheng Zhou, Ruifu Yang&quot;</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#  $Year</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#  [1] 2007</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#  $Journal</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#  [1] &quot;BMC Microbiology&quot;</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#  $Volume</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#  [1] &quot;7&quot;</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#  $Pages</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#  [1] &quot;96&quot;</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#  $`Published online`</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#  [1] &quot;2007-10-29&quot;</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#  $`Date received`</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#  [1] &quot;2007-6-2&quot;</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#  $DOI</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#  [1] &quot;10.1186/1471-2180-7-96&quot;</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#  </span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#  $Publisher</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#  [1] &quot;BioMed Central&quot;</span></a></code></pre></div>
<div id="searching-text" class="section level2">
<h2>Searching text</h2>
<p>There are a few functions to search within the <code>pmc_text</code> or collapsed <code>pmc_table</code> output. <code>separate_text</code> uses the <a href="https://stringr.tidyverse.org/">stringr</a> package to extract any matching regular expression.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">separate_text</span>(txt, <span class="st">&quot;[ATCGN]{5,}&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#  # A tibble: 9 x 5</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#    match       section                       paragraph sentence text                                 </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#    &lt;chr&gt;       &lt;chr&gt;                             &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#  1 ACGCAATCGT… Results and Discussion; Comp…         2        3 A 16 basepair (bp) box (5'-ACGCAATCG…</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#  2 AAACGTTTNC… Results and Discussion; Comp…         2        4 It is very similar to the E. coli Pu…</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#  3 TGATAATGAT… Results and Discussion; Comp…         2        5 A 21 bp box (5'-TGATAATGATTATCATTATC…</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#  4 GATAATGATA… Results and Discussion; Comp…         2        6 It is a 10-1-10 inverted repeat that…</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#  5 TGANNNNNNT… Results and Discussion; Comp…         2        7 A 15 bp box (5'-TGANNNNNNTCAA-3') wa…</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#  6 TTGATN      Results and Discussion; Comp…         2        8 It is a part of the E. coli Fnr box …</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#  7 NATCAA      Results and Discussion; Comp…         2        8 It is a part of the E. coli Fnr box …</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#  8 GTTAATTAA   Results and Discussion; Comp…         3        4 The ArcA regulator can recognize a r…</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#  9 GTTAATTAAT… Results and Discussion; Comp…         3        5 An ArcA-box-like sequence (5'-GTTAAT…</span></a></code></pre></div>
<p>A few wrappers search pre-defined patterns and add an extra step to expand matched ranges. <code>separate_refs</code> matches references within brackets using <code>\\[[0-9, -]+\\]</code> and expands ranges like <code>[7-9]</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">separate_refs</span>(txt)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">x</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#  # A tibble: 93 x 6</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#        id match section   paragraph sentence text                                                    </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;         &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                                   </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#   1     1 [1]   Backgrou…         1        1 Yersinia pestis is the etiological agent of plague, alt…</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#   2     2 [2]   Backgrou…         1        3 To produce a transmissible infection, Y. pestis coloniz…</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#   3     3 [3]   Backgrou…         1        9 However, a few bacilli are taken up by tissue macrophag…</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#   4     4 [4,5] Backgrou…         1       10 Residence in this niche also facilitates the bacteria's…</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#   5     5 [4,5] Backgrou…         1       10 Residence in this niche also facilitates the bacteria's…</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#   6     6 [6]   Backgrou…         2        1 A DNA microarray is able to determine simultaneous chan…</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#   7     7 [7-9] Backgrou…         2        2 We and others have measured the gene expression profile…</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#   8     8 [7-9] Backgrou…         2        2 We and others have measured the gene expression profile…</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#   9     9 [7-9] Backgrou…         2        2 We and others have measured the gene expression profile…</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#  10    10 [10]  Backgrou…         2        2 We and others have measured the gene expression profile…</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#  # … with 83 more rows</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="kw">filter</span>(x, id <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#  # A tibble: 5 x 6</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#       id match    section                         paragraph sentence text                            </span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;                               &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                           </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#  1     8 [7-9]    Background                              2        2 We and others have measured the…</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#  2     8 [8-13,1… Background                              2        4 In order to acquire more regula…</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#  3     8 [7-13,1… Results and Discussion                  2        1 Recently, many signature expres…</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#  4     8 [7-9]    Results and Discussion; Virule…         3        1 As described previously, expres…</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#  5     8 [8-10]   Methods; Collection of microar…         1        6 The genome-wide transcriptional…</span></a></code></pre></div>
<p><code>separate_genes</code> expands microbial gene operons like <code>hmsHFRS</code> into four separate genes.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">separate_genes</span>(txt)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#  # A tibble: 103 x 6</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#     gene  match  section                         paragraph sentence text                             </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;                               &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                            </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#   1 purR  PurR   Abstract                                2        5 Several regulatory DNA motifs, p…</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#   2 phoP  PhoP   Background                              2        3 We also identified the regulons …</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#   3 ompR  OmpR   Background                              2        3 We also identified the regulons …</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#   4 oxyR  OxyR   Background                              2        3 We also identified the regulons …</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#   5 csrA  CsrA   Results and Discussion                  1        3 After the determination of the C…</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#   6 slyA  SlyA   Results and Discussion                  1        3 After the determination of the C…</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#   7 phoPQ PhoPQ  Results and Discussion                  1        3 After the determination of the C…</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#   8 hmsH  hmsHF… Results and Discussion; Virule…         3        3 For example, the hemin storage l…</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#   9 hmsF  hmsHF… Results and Discussion; Virule…         3        3 For example, the hemin storage l…</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#  10 hmsR  hmsHF… Results and Discussion; Virule…         3        3 For example, the hemin storage l…</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#  # … with 93 more rows</span></a></code></pre></div>
<p>Finally, <code>separate_tags</code> expands locus tag ranges.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">collapse_rows</span>(tab1, <span class="dt">na=</span><span class="st">&quot;-&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw">separate_tags</span>(<span class="st">&quot;YPO&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#  # A tibble: 270 x 5</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#     id      match      table    row text                                                             </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#     &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;                                                            </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#   1 YPO2439 YPO2439-2… Table…     1 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#   2 YPO2440 YPO2439-2… Table…     1 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#   3 YPO2441 YPO2439-2… Table…     1 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#   4 YPO2442 YPO2439-2… Table…     1 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#   5 YPO0279 YPO0279-0… Table…     2 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#   6 YPO0280 YPO0279-0… Table…     2 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#   7 YPO0281 YPO0279-0… Table…     2 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#   8 YPO0282 YPO0279-0… Table…     2 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#   9 YPO0283 YPO0279-0… Table…     2 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#  10 YPO1529 YPO1529-1… Table…     3 subheading=Iron uptake or heme synthesis; Potential operon (r va…</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#  # … with 260 more rows</span></a></code></pre></div>
<div id="using-xml2" class="section level3">
<h3>Using <code>xml2</code></h3>
<p>The <code>pmc_*</code> functions use the <a href="https://github.com/r-lib/xml2">xml2</a> package for parsing and may fail in some situations, so it helps to know how to parse <code>xml_documents</code>. Use <code>cat</code> and <code>as.character</code> to view nodes returned by <code>xml_find_all</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">library</span>(xml2)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">refs &lt;-<span class="st"> </span><span class="kw">xml_find_all</span>(doc, <span class="st">&quot;//ref&quot;</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">refs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#  {xml_nodeset (1)}</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#  [1] &lt;ref id=&quot;B1&quot;&gt;\n  &lt;citation citation-type=&quot;journal&quot;&gt;\n    &lt;person-group person-group-type=&quot;aut ...</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="kw">cat</span>(<span class="kw">as.character</span>(refs[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#  &lt;ref id=&quot;B1&quot;&gt;</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#    &lt;citation citation-type=&quot;journal&quot;&gt;</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#      &lt;person-group person-group-type=&quot;author&quot;&gt;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#        &lt;name&gt;</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#          &lt;surname&gt;Perry&lt;/surname&gt;</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#          &lt;given-names&gt;RD&lt;/given-names&gt;</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#        &lt;/name&gt;</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#        &lt;name&gt;</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#          &lt;surname&gt;Fetherston&lt;/surname&gt;</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#          &lt;given-names&gt;JD&lt;/given-names&gt;</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#        &lt;/name&gt;</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#      &lt;/person-group&gt;</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#      &lt;article-title&gt;Yersinia pestis--etiologic agent of plague&lt;/article-title&gt;</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">#      &lt;source&gt;Clin Microbiol Rev&lt;/source&gt;</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#      &lt;year&gt;1997&lt;/year&gt;</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">#      &lt;volume&gt;10&lt;/volume&gt;</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="co">#      &lt;fpage&gt;35&lt;/fpage&gt;</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="co">#      &lt;lpage&gt;66&lt;/lpage&gt;</span></a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="co">#      &lt;pub-id pub-id-type=&quot;pmid&quot;&gt;8993858&lt;/pub-id&gt;</span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">#    &lt;/citation&gt;</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="co">#  &lt;/ref&gt;</span></a></code></pre></div>
<p>Many journals use superscripts for references cited so they usually appear after words like <code>results9</code> below.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># doc1 &lt;- pmc_xml(&quot;PMC6385181&quot;)</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">doc1 &lt;-<span class="st"> </span><span class="kw">read_xml</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata/PMC6385181.xml&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;tidypmc&quot;</span>))</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">gsub</span>(<span class="st">&quot;.*</span><span class="ch">\\</span><span class="st">. &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">xml_text</span>( <span class="kw">xml_find_all</span>(doc1, <span class="st">&quot;//sec/p&quot;</span>))[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#  [1] &quot;RNA-seq identifies the most relevant genes and RT-qPCR validates its results9, especially in the field of environmental and host adaptation10,11 and antimicrobial response12.&quot;</span></a></code></pre></div>
<p>Find the tags using <code>xml_find_all</code> and then update the nodes by adding brackets or other text.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">bib &lt;-<span class="st"> </span><span class="kw">xml_find_all</span>(doc1, <span class="st">&quot;//xref[@ref-type='bibr']&quot;</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">bib[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#  {xml_nodeset (1)}</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#  [1] &lt;xref ref-type=&quot;bibr&quot; rid=&quot;CR1&quot;&gt;1&lt;/xref&gt;</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="kw">xml_text</span>(bib) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot; [&quot;</span>, <span class="kw">xml_text</span>(bib), <span class="st">&quot;]&quot;</span>)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">bib[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#  {xml_nodeset (1)}</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#  [1] &lt;xref ref-type=&quot;bibr&quot; rid=&quot;CR1&quot;&gt; [1]&lt;/xref&gt;</span></a></code></pre></div>
<p>The text is now separated from the reference. Note the <code>pmc_text</code> function adds the brackets by default.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">gsub</span>(<span class="st">&quot;.*</span><span class="ch">\\</span><span class="st">. &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">xml_text</span>( <span class="kw">xml_find_all</span>(doc1, <span class="st">&quot;//sec/p&quot;</span>))[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#  [1] &quot;RNA-seq identifies the most relevant genes and RT-qPCR validates its results [9], especially in the field of environmental and host adaptation [10], [11] and antimicrobial response [12].&quot;</span></a></code></pre></div>
<p>Genes, species and many other terms are often included within italic tags. You can mark these nodes using the same code above or simply list all the names in italics and search text or tables for matches, for example three letter gene names in text below.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">xml_name</span>(<span class="kw">xml_find_all</span>(doc, <span class="st">&quot;//*&quot;</span>))</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw">tibble</span>(<span class="dt">tag=</span>x) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="st">  </span><span class="kw">count</span>(tag, <span class="dt">sort=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#  # A tibble: 84 x 2</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#     tag               n</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#     &lt;chr&gt;         &lt;int&gt;</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#   1 td              398</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#   2 given-names     388</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#   3 name            388</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#   4 surname         388</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">#   5 italic          235</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">#   6 pub-id          129</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">#   7 tr              117</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co">#   8 xref            108</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co">#   9 year             80</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="co">#  10 article-title    77</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="co">#  # … with 74 more rows</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19">it &lt;-<span class="st"> </span><span class="kw">xml_text</span>(<span class="kw">xml_find_all</span>(doc, <span class="st">&quot;//sec//p//italic&quot;</span>), <span class="dt">trim=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-20" data-line-number="20">it2 &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">italic=</span>it) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="st">  </span><span class="kw">count</span>(italic, <span class="dt">sort=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-22" data-line-number="22">it2</a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="co">#  # A tibble: 53 x 2</span></a>
<a class="sourceLine" id="cb17-24" data-line-number="24"><span class="co">#     italic              n</span></a>
<a class="sourceLine" id="cb17-25" data-line-number="25"><span class="co">#     &lt;chr&gt;           &lt;int&gt;</span></a>
<a class="sourceLine" id="cb17-26" data-line-number="26"><span class="co">#   1 Y. pestis          46</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27"><span class="co">#   2 in vitro            5</span></a>
<a class="sourceLine" id="cb17-28" data-line-number="28"><span class="co">#   3 E. coli             4</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="co">#   4 psaEFABC            3</span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30"><span class="co">#   5 r                   3</span></a>
<a class="sourceLine" id="cb17-31" data-line-number="31"><span class="co">#   6 Yersinia            2</span></a>
<a class="sourceLine" id="cb17-32" data-line-number="32"><span class="co">#   7 Yersinia pestis     2</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33"><span class="co">#   8 cis                 2</span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34"><span class="co">#   9 fur                 2</span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35"><span class="co">#  10 n                   2</span></a>
<a class="sourceLine" id="cb17-36" data-line-number="36"><span class="co">#  # … with 43 more rows</span></a>
<a class="sourceLine" id="cb17-37" data-line-number="37"><span class="kw">filter</span>(it2, <span class="kw">nchar</span>(italic) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb17-38" data-line-number="38"><span class="co">#  # A tibble: 8 x 2</span></a>
<a class="sourceLine" id="cb17-39" data-line-number="39"><span class="co">#    italic     n</span></a>
<a class="sourceLine" id="cb17-40" data-line-number="40"><span class="co">#    &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb17-41" data-line-number="41"><span class="co">#  1 cis        2</span></a>
<a class="sourceLine" id="cb17-42" data-line-number="42"><span class="co">#  2 fur        2</span></a>
<a class="sourceLine" id="cb17-43" data-line-number="43"><span class="co">#  3 cys        1</span></a>
<a class="sourceLine" id="cb17-44" data-line-number="44"><span class="co">#  4 hmu        1</span></a>
<a class="sourceLine" id="cb17-45" data-line-number="45"><span class="co">#  5 ybt        1</span></a>
<a class="sourceLine" id="cb17-46" data-line-number="46"><span class="co">#  6 yfe        1</span></a>
<a class="sourceLine" id="cb17-47" data-line-number="47"><span class="co">#  7 yfu        1</span></a>
<a class="sourceLine" id="cb17-48" data-line-number="48"><span class="co">#  8 ymt        1</span></a>
<a class="sourceLine" id="cb17-49" data-line-number="49"><span class="kw">separate_text</span>(txt, <span class="kw">c</span>(<span class="st">&quot;fur&quot;</span>, <span class="st">&quot;cys&quot;</span>, <span class="st">&quot;hmu&quot;</span>, <span class="st">&quot;ybt&quot;</span>, <span class="st">&quot;yfe&quot;</span>, <span class="st">&quot;yfu&quot;</span>, <span class="st">&quot;ymt&quot;</span>))</a>
<a class="sourceLine" id="cb17-50" data-line-number="50"><span class="co">#  # A tibble: 9 x 5</span></a>
<a class="sourceLine" id="cb17-51" data-line-number="51"><span class="co">#    match section                               paragraph sentence text                               </span></a>
<a class="sourceLine" id="cb17-52" data-line-number="52"><span class="co">#    &lt;chr&gt; &lt;chr&gt;                                     &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                              </span></a>
<a class="sourceLine" id="cb17-53" data-line-number="53"><span class="co">#  1 ymt   Results and Discussion; Virulence ge…         3        4 The ymt gene encoding Yersinia mur…</span></a>
<a class="sourceLine" id="cb17-54" data-line-number="54"><span class="co">#  2 fur   Results and Discussion; Clustering a…         3        2 It is noticeable that almost all o…</span></a>
<a class="sourceLine" id="cb17-55" data-line-number="55"><span class="co">#  3 yfe   Results and Discussion; Clustering a…         3        4 Genes in category A (yfe, hmu, yfu…</span></a>
<a class="sourceLine" id="cb17-56" data-line-number="56"><span class="co">#  4 hmu   Results and Discussion; Clustering a…         3        4 Genes in category A (yfe, hmu, yfu…</span></a>
<a class="sourceLine" id="cb17-57" data-line-number="57"><span class="co">#  5 yfu   Results and Discussion; Clustering a…         3        4 Genes in category A (yfe, hmu, yfu…</span></a>
<a class="sourceLine" id="cb17-58" data-line-number="58"><span class="co">#  6 ybt   Results and Discussion; Clustering a…         3        4 Genes in category A (yfe, hmu, yfu…</span></a>
<a class="sourceLine" id="cb17-59" data-line-number="59"><span class="co">#  7 cys   Results and Discussion; Clustering a…         4        2 Genes responsible for sulfur uptak…</span></a>
<a class="sourceLine" id="cb17-60" data-line-number="60"><span class="co">#  8 cys   Results and Discussion; Clustering a…         4        3 Cluster III contains members of th…</span></a>
<a class="sourceLine" id="cb17-61" data-line-number="61"><span class="co">#  9 fur   Methods; Gel mobility shift analysis…         1        1 The entire coding region of the fu…</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
